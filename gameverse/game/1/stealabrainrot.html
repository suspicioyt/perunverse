<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Steal a Brainrot | Perun Gameverse</title>
    <link rel="icon" type="image/x-icon" href="https://suspicioyt.github.io/perunverse/logo/gameverse.png">
    <link rel="stylesheet" href="https://suspicioyt.github.io/perunverse/gameverse/style/public.css">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e3a8a, #3b82f6);
            color: #fff;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h1 {
            font-size: 2.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
        }

        #game-container {
            position: relative;
            width: 1000px;
            height: 800px;
            background: #1e293b;
            border-radius: 15px;
            border: 3px solid #60a5fa;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }

        #path {
            position: absolute;
            top: 100px;
            left: 0;
            width: 100%;
            height: 160px;
            background: linear-gradient(to right, #4b5563, #6b7280);
            border-top: 2px solid #9ca3af;
            border-bottom: 2px solid #9ca3af;
        }

        .brainrot, .lucky-block {
            position: absolute;
            width: 110px;
            height: 140px;
            background: #fff;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .brainrot:hover, .lucky-block:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        .brainrot img, .lucky-block img {
            width: 50px;
            border-radius: 50%;
            border: 2px solid #fff;
        }

        .brainrot span, .lucky-block span {
            font-size: 12px;
            text-align: center;
            margin-top: 5px;
            color: #1e293b;
        }

        .common { background: linear-gradient(#d1d5db, #9ca3af); }
        .uncommon { background: linear-gradient(#6ee7b7, #34d399); }
        .rare { background: linear-gradient(#60a5fa, #3b82f6); }
        .epic { background: linear-gradient(#735eb2, #7c3aed); }
        .legendary { background: linear-gradient(#facc15, #eab308); }
        .mythic { background: linear-gradient(#e24829, #df0808); }
        .god { background: linear-gradient(#fbf782, #f7ff5e); }
        .secret { background: linear-gradient(#16bcf9, #76a9e3); }
        .og { background: linear-gradient(#ec4899, #db2777); }
        .admin { background: linear-gradient(#374151, #1f2937); }
        .admin span { color: #fff; }
        .exclusive { background: linear-gradient(#8426dc, #1c1cb9); }
        .exclusive span { color: #fff; }
        .taco { background: linear-gradient(#13f50b, #12b700); }
        .lucky-block { background: linear-gradient(#fef08a, #facc15); }

        #base {
            position: absolute;
            bottom: 50px;
            left: 100px;
            width: 800px;
            height: 400px;
            background: #2d3748;
            border-radius: 10px;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            padding: 20px;
            border: 2px solid #4b5563;
        }

        .station {
            background: #4b5563;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: transform 0.2s, background 0.2s;
        }

        .station:hover {
            transform: scale(1.05);
        }

        .station.drag-over {
            background: #60a5fa;
            border: 2px solid #fff;
        }

        .station .brainrot {
            cursor: grab;
        }

        .station .brainrot:active {
            cursor: grabbing;
        }

        .station .money-bubble {
            position: absolute;
            top: -20px;
            background: #facc15;
            color: #1e293b;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 20px;
            cursor: pointer;
            display: none;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .station .money-bubble.visible {
            display: block;
        }

        #money, #income {
            font-size: 1.5rem;
            margin: 10px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        #controls {
            margin: 20px;
            display: flex;
            gap: 10px;
        }

        button {
            padding: 10px 20px;
            font-size: 1rem;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.2s;
        }

        button:hover {
            background: #2563eb;
        }

        #index-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        #index-content {
            background: #1e293b;
            border-radius: 10px;
            padding: 20px;
            max-width: 90%;
            max-height: 80%;
            overflow: auto;
            color: #fff;
        }

        #index-controls {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
        }

        #index-search {
            padding: 8px;
            border-radius: 5px;
            border: none;
            width: 200px;
        }

        #index-sort, #index-filter {
            padding: 8px;
            border-radius: 5px;
            border: none;
        }

        .rarity-section {
            margin-bottom: 20px;
        }

        .rarity-section h3 {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #60a5fa;
        }

        .index-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .index-item {
            text-align: center;
        }

        .index-item img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid #fff;
        }

        .index-item img:hover {
            transform: scale(1.1);
        }

        .particle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: #facc15;
            border-radius: 50%;
            pointer-events: none;
            animation: particleAnim 0.8s ease-out forwards;
        }

        @keyframes particleAnim {
            0% { opacity: 1; transform: translate(0, 0); }
            100% { opacity: 0; transform: translate(var(--dx), var(--dy)); }
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .modal div {
            background: #1e293b;
            border-radius: 10px;
            padding: 20px;
            max-width: 400px;
            text-align: center;
            color: #fff;
        }

        .modal img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 2px solid #fff;
        }

        .modal h3 {
            font-size: 1.5rem;
            margin: 10px 0;
        }

        .modal p {
            font-size: 1rem;
            margin: 5px 0;
        }

        .modal button {
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h1>Steal a Brainrot</h1>
    <div id="money">Pieniądze: 50</div>
    <div id="income">Dochód/s: 0</div>
    <div id="game-container">
        <div id="path"></div>
        <div id="base">
            <div class="station" id="station1"></div>
            <div class="station" id="station2"></div>
            <div class="station" id="station3"></div>
            <div class="station" id="station4"></div>
            <div class="station" id="station5"></div>
            <div class="station" id="station6"></div>
            <div class="station" id="station7"></div>
            <div class="station" id="station8"></div>
        </div>
    </div>
    <div id="controls">
        <button id="showIndex">Pokaż Index</button>
        <button id="resetGame">Resetuj Grę</button>
    </div>
    <div id="index-modal">
        <div id="index-content">
            <h2>Index</h2>
            <div id="index-controls">
                <input id="index-search" placeholder="Szukaj..." type="text">
                <select id="index-sort">
                    <option value="rarity-asc">Rzadkość rosnąco</option>
                    <option value="rarity-desc">Rzadkość malejąco</option>
                    <option value="name-asc">Nazwa A-Z</option>
                    <option value="name-desc">Nazwa Z-A</option>
                    <option value="value-asc">Wartość rosnąco</option>
                    <option value="value-desc">Wartość malejąco</option>
                </select>
                <select id="index-filter">
                    <option value="">Wszystkie</option>
                    <option value="common">Common</option>
                    <option value="rare">Rare</option>
                    <option value="epic">Epic</option>
                    <option value="legendary">Legendary</option>
                    <option value="mythic">Mythic</option>
                    <option value="god">God</option>
                    <option value="secret">Secret</option>
                    <option value="og">OG</option>
                    <option value="admin">Admin</option>
                    <option value="exclusive">Exclusive</option>
                    <option value="taco">Taco</option>
                </select>
            </div>
            <div id="index-sections"></div>
        </div>
    </div>
    <script src="https://suspicioyt.github.io/perunverse/data/localData.js"></script>
    <script>
        let money = 50;
        let brainrots = [];
        let luckyItems = [];
        let lastFrameTime = performance.now();
        let stations = Array.from({length: 8}, (_, i) => document.getElementById(`station${i+1}`));
        let incomePerSecond = 0;
        let unlocked = new Set();

        const moneyDisplay = document.getElementById('money');
        const incomeDisplay = document.getElementById('income');
        const gameContainer = document.getElementById('game-container');
        const indexSections = document.getElementById('index-sections');
        const indexModal = document.getElementById('index-modal');
        const showIndexButton = document.getElementById('showIndex');
        const resetGameButton = document.getElementById('resetGame');
        const indexSearch = document.getElementById('index-search');
        const indexSort = document.getElementById('index-sort');
        const indexFilter = document.getElementById('index-filter');

        const rarities = [
            { name: 'Noobini Pizzanini', color: 'common', value: 1, cost: 25, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Noobini_Pizzanini.webp' },
            { name: 'Lirilì Larilà', color: 'common', value: 3, cost: 250, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Liliri_Lalira.webp' },
            { name: 'Tim Cheese', color: 'common', value: 5, cost: 500, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Tim_Cheese.webp' },
            { name: 'Fluriflura', color: 'common', value: 7, cost: 750, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Fluriflura.webp' },
            { name: 'Talpa Di Fero', color: 'common', value: 9, cost: 1000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Talpa_Di_Fero.webp' },
            { name: 'Svinina Bombardino', color: 'common', value: 10, cost: 1200, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Svinina_Bombardino.webp' },
            { name: 'Pipi Kiwi', color: 'common', value: 13, cost: 1500, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Pipi_Kiwi.webp' },
            { name: 'Pipi Corni', color: 'common', value: 14, cost: 1700, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Pipi_Corni.webp' },
            
            { name: 'Trippi Troppi', color: 'rare', value: 15, cost: 2000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Trippi_Troppi.webp' },
            { name: 'Tung Tung Tung Sahur', color: 'rare', value: 25, cost: 3000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Tung_Tung_Tung_Sahur.webp' },
            { name: 'Gangster Footera', color: 'rare', value: 30, cost: 4000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Gangster_Footera.webp' },
            { name: 'Bandito Bobritto', color: 'rare', value: 35, cost: 4500, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Bandito_Bobritto.webp' },
            { name: 'Boneca Ambalabu', color: 'rare', value: 40, cost: 5000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Boneca_Ambalabu.webp' },
            { name: 'Cacto Hipopotamo', color: 'rare', value: 50, cost: 6500, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Cacto_Hipopotamo.webp' },
            { name: 'Ta Ta Ta Ta Sahur', color: 'rare', value: 55, cost: 7500, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Ta_Ta_Sahur.webp' },
            { name: 'Tric-Trac-Baraboom', color: 'rare', value: 65, cost: 9000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Tric_Trac_Baraboom.webp' },
            { name: 'Pipi Avocado', color: 'rare', value: 70, cost: 9500, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Pipi_Avocado.webp' },
            
            { name: 'Cappuccino Assassino', color: 'epic', value: 90, cost: 12500, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Cappuccino_Assassino.webp' },
            { name: 'Bandito Axolito', color: 'epic', value: 75, cost: 10000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Bandito_Axolito.webp' },
            { name: 'Brr Brr Patapim', color: 'epic', value: 100, cost: 15000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Brr_Brr_Patapim.webp' },
            { name: 'Avocadini Antilopini', color: 'epic', value: 115, cost: 17500, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Avocadini_Antilopini.webp' },
            { name: 'Trulimero Trulicina', color: 'epic', value: 125, cost: 20000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Trulimero_Trulicina.webp' },
            { name: 'Bambini Crostini', color: 'epic', value: 140, cost: 23500, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Bambini_Crostini.webp' },
            { name: 'Malame Amarele', color: 'epic', value: 150, cost: 25000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Malame_Amarele.webp' },
            { name: 'Bananita Dolphinita', color: 'epic', value: 150, cost: 25000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Bananita_Dolphinita.webp' },
            { name: 'Perochello Lemonchello', color: 'epic', value: 160, cost: 27500, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Perochello_Lemonchello.webp' },
            { name: 'Brri Brri Bicus Dicus Bombicus', color: 'epic', value: 175, cost: 30000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Bicus_Dicus_Bombicus.webp' },
            { name: 'Ti Ti Ti Sahur', color: 'epic', value: 225, cost: 37500, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Ti_Ti_Sahur.webp' },
            { name: 'Avocadini Guffo', color: 'epic', value: 225, cost: 35000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Avocadini_Guffo.webp' },
            { name: 'Mangolini Parrocini', color: 'epic', value: 235, cost: 38500, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Mangolini_Parrocini.webp' },
            { name: 'Salamino Penguino', color: 'epic', value: 250, cost: 40000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Salamino_Penguino.webp' },
            { name: 'Penguino Cocosino', color: 'epic', value: 300, cost: 45000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Penguino_Cocosino.webp' },
            
            { name: 'Burbaloni Loliloli', color: 'legendary', value: 200, cost: 35000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Burbaloni_Loliloli.webp' },
            { name: 'Chimpazini Bananini', color: 'legendary', value: 300, cost: 50000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Chimpanzini_Bananini.webp' },
            { name: 'Tirilikalika Tirilikalako', color: 'legendary', value: 450, cost: 75000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Tirilikalika_Tirilikalako.webp' },
            { name: 'Ballerina Cappuccina', color: 'legendary', value: 500, cost: 100000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Ballerina_Cappuccina.webp' },
            { name: 'Chef Crabracadabra', color: 'legendary', value: 600, cost: 150000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Chef_Crabracadabra.webp' },
            { name: 'Lionel Cactuseli', color: 'legendary', value: 650, cost: 175000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Lionel_Cactuseli.webp' },
            { name: 'Glorbo Fruttodrillo', color: 'legendary', value: 750, cost: 200000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Glorbo_Fruttodrillo.webp' },
            { name: 'Quivoli Ameleoni', color: 'legendary', value: 900, cost: 225000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Quivioli_Ameleonni.webp' },
            { name: 'Blueberrini Octopusini', color: 'legendary', value: 1000, cost: 250000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Blueberrini_Octopusini.webp' },
            { name: 'Caramello Filtrello', color: 'legendary', value: 1000, cost: 255000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Caramello_Filtrello.webp' },
            { name: 'Pipi Potato', color: 'legendary', value: 1100, cost: 256000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Pipi_Potato.webp' },
            { name: 'Strawberrini Flamingelli', color: 'legendary', value: 1100, cost: 275000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Strawberrini_Flamingelli.webp' },
            { name: 'Cocosini Mama', color: 'legendary', value: 1200, cost: 285000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Cocosini_Mama.webp' },
            { name: 'Pandaccini Bananini', color: 'legendary', value: 1200, cost: 300000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Pandaccini_Bananini.webp' },
            { name: 'Signore Carapace', color: 'legendary', value: 1300, cost: 320000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Signore_Carapace.webp' },
            { name: 'Sigma Boy', color: 'legendary', value: 1300, cost: 325000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Sigma_Boy.webp' },
            { name: 'Pi Pi Watermelon', color: 'legendary', value: 1300, cost: 135000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Pi_Pi_Watermelon.webp' },
            
            { name: 'Frigo Camelo', color: 'mythic', value: 1400, cost: 300000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Frigo_Camelo.webp' },
            { name: 'Orangutini Ananassini', color: 'mythic', value: 1700, cost: 400000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Orangutini_Ananassini.webp' },
            { name: 'Rhino Toasterino', color: 'mythic', value: 2100, cost: 450000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Rhino_Toasterino.webp' },
            { name: 'Bombardiro Crocodilo', color: 'mythic', value: 2500, cost: 500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Bombardiro_Crocodilo.webp' },
            { name: 'Bruto Gialutto', color: 'mythic', value: 3000, cost: 600000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Bruto_Gialutto.webp' },
            { name: 'Bombombini Gusini', color: 'mythic', value: 5000, cost: 1000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Bombombini_Gusini.webp' },
            { name: 'Cavallo Virtuso', color: 'mythic', value: 7500, cost: 2500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Cavallo_Virtuoso.webp' },
            { name: 'Gorillo Subwoofero', color: 'mythic', value: 8000, cost: 3000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Gorillo_Subwoofero.webp' },
            { name: 'Gorillo Watermelondrillo', color: 'mythic', value: 8000, cost: 3000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Gorillo_Watermelondrillo.webp' },
            { name: 'Avocadorilla', color: 'mythic', value: 7500, cost: 2000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Avocadorilla.webp' },
            { name: 'Tob Tobi Tobi', color: 'mythic', value: 8500, cost: 3500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Tob_Tobi_Tobi.webp' },
            { name: 'Ganganzelli Trulala', color: 'mythic', value: 9000, cost: 4000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Ganganzelli_Trulala.webp' },
            { name: 'Te Te Te Sahur', color: 'mythic', value: 9500, cost: 2500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Te_Te_Te_Sahur.webp' },
            { name: 'Tracoducotulu Delapeladustuz', color: 'mythic', value: 12000, cost: 3000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Tracoducotulu_Delapeladustuz.webp' },
            { name: 'Lerulerulerule', color: 'mythic', value: 8700, cost: 3500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Lerulerulerule.webp' },
            { name: 'Los Noobinis', color: 'mythic', value: 12500, cost: 4300000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Los_Noobinis.webp' },
            { name: 'Carrotini Brainini', color: 'mythic', value: 15000, cost: 4700000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Carrotini_Brainini.webp' },
            { name: 'Spioniro Golubiro', color: 'mythic', value: 3500, cost: 750000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Spioniro_Golubiro.webp' },
            { name: 'Zibra Zubra Zibralini', color: 'mythic', value: 6000, cost: 1000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Zibra_Zubra_Zibralini.webp' },
            { name: 'Tigrilini Watermelini', color: 'mythic', value: 6500, cost: 1000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Tigrilini_Watermelini.webp' },
            
            { name: 'Cocofanto Elefanto', color: 'god', value: 10000, cost: 5000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Cocofanto_Elefanto.webp' },
            { name: 'Antonio', color: 'god', value: 18500, cost: 6000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Antonio.webp' },
            { name: 'Girafa Celestre', color: 'god', value: 20000, cost: 7500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Girafa_Celestre.webp' },
            { name: 'Brr es Teh Patipum', color: 'god', value: 225000, cost: 40000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Brr_Es_Teh_Patipum.webp' },
            { name: 'Tralalero Tralala', color: 'god', value: 50000, cost: 10000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Tralalero_Tralala.webp' },
            { name: 'Odin Din Din Dun', color: 'god', value: 75000, cost: 15000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Odin_Din_Din_Dun.webp' },
            { name: 'Ballerino Lololo', color: 'god', value: 200000, cost: 35000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Ballerino_Lololo.webp' },
            { name: 'Los Orcalitos', color: 'god', value: 235000, cost: 45000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Los_Orcalitos.webp' },
            { name: 'Tralalita Tralala', color: 'god', value: 100000, cost: 20000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Tralalita_Tralala.webp' },
            { name: 'Trigoligre Frutonni', color: 'god', value: 60000, cost: 15000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Trigoligre_Frutonni.webp' },
            { name: 'Orcalero Orcala', color: 'god', value: 100000, cost: 15000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Orcalero_Orcala.webp' },
            { name: 'Trenostruzzo Turbo 3000', color: 'god', value: 150000, cost: 25000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Trenostruzzo_Turbo_3000.webp' },
            { name: 'Bulbito Bandito Traktorito', color: 'god', value: 205000, cost: 25000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Bulbito_Bandito_Traktorito.webp' },
            { name: 'Los Crocodillitos', color: 'god', value: 55000, cost: 12500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Los_Crocodillitos.webp' },
            { name: 'Extinct Ballerina', color: 'god', value: 125000, cost: 23500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Extinct_Ballerina.webp' },
            { name: 'Piccione Macchina', color: 'god', value: 225000, cost: 40000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Piccione_Macchina.webp' },
            { name: 'Trippi Troppi Troppa Trippa', color: 'god', value: 175000, cost: 30000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Trippi_Troppi_Troppa_Trippa.webp' },
            { name: 'Los Tungtungtungcitos', color: 'god', value: 210000, cost: 37500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Los_Tungtungtungcitos.webp' },
            { name: 'Tukanno Bananno', color: 'god', value: 100000, cost: 22500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Tukanno_Bananno.webp' },
            { name: 'Belula Beluga', color: 'god', value: 290000, cost: 60000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Belula_Beluga.webp' },
            { name: 'Las Cappuchinas', color: 'god', value: 135000, cost: 82500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Las_Cappuchinas.webp' },
            { name: 'Orcalita Orcala', color: 'god', value: 240000, cost: 45000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Orcalita_Orcala.webp' },
            { name: 'Cacasito Satalito', color: 'god', value: 240000, cost: 45000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Cacasito_Satalito.webp' },
            { name: 'Tartaruga Cisterna', color: 'god', value: 250000, cost: 45000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Tartaruga_Cisterna.webp' },
            { name: 'Piccionetta Machina', color: 'god', value: 270000, cost: 47000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Piccionetta_Machina.webp' },
            { name: 'Mastodontico Telepiedone', color: 'god', value: 275000, cost: 47500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Mastodontico_Telepiedone.webp' },
            { name: 'Anpali Babel', color: 'god', value: 280000, cost: 48000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Anpali_Babel.webp' },
            { name: 'Pakrahmatmamat', color: 'god', value: 215000, cost: 37500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Pakrahmatmamat.webp' },
            
            { name: 'La Vacca Staturno Saturnita', color: 'secret', value: 250000, cost: 50000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/La_Vacca_Saturno_Saturnita.webp' },
            { name: 'Chachechi', color: 'secret', value: 400000, cost: 85000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Chachechi.webp' },
            { name: 'Trenostruzzo Turbo 4000', color: 'secret', value: 310000, cost: 100000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Trenostruzzo_Turbo_4000.webp' },
            { name: 'Extinct Tralalero', color: 'secret', value: 450000, cost: 125000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Extinct_Tralalero.webp' },
            { name: 'Extinct Matteo', color: 'secret', value: 625000, cost: 140000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Extinct_Matteo.webp' },
            { name: 'Los Tralaleritos', color: 'secret', value: 500000, cost: 150000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Los_Tralaleritos.webp' },
            { name: 'Las Tralaleritas', color: 'secret', value: 650000, cost: 150000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Las_Tralaleritas.webp' },
            { name: 'Job Job Job Sahur', color: 'secret', value: 700000, cost: 175000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Job_Job_Job_Sahur.webp' },
            { name: 'Graipuss Medussi', color: 'secret', value: 1000000, cost: 250000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Graipuss_Medussi.webp' },
            { name: 'La Grande Combinasion', color: 'secret', value: 10000000, cost: 1000000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/La_Grande_Combinasion.webp' },
            { name: 'Los Chicleteiras', color: 'secret', value: 7000000, cost: 1200000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Los_Chicleteiras.webp' },
            { name: '67', color: 'secret', value: 7500000, cost: 1200000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/67.webp' },
            { name: 'Los Combinasionas', color: 'secret', value: 15000000, cost: 2000000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Los_Combinasionas.webp' },
            { name: 'Los Bros', color: 'secret', value: 24000000, cost: 2600000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Los_Bros.webp' },
            { name: 'La Extinct Grande', color: 'secret', value: 23500000, cost: 3200000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/La_Extinct_Grande.webp' },
            { name: 'Garama and Madundung', color: 'secret', value: 50000000, cost: 10000000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Garama_and_Madundung.webp' },
            { name: 'La Sahur Combinasion', color: 'secret', value: 2000000, cost: 550000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/La_Sahur_Combinasion.webp' },
            { name: 'Tortuginni Dragonfruitini', color: 'secret', value: 350000, cost: 500000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Torrtuginni_Dragonfrutini.webp' },
            { name: 'Pot Hotspot', color: 'secret', value: 2500000, cost: 500000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Pot_Hotspot.webp' },
            { name: 'Las Vaquitas Saturnitas', color: 'secret', value: 750000, cost: 160000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Las_Vaquitas_Saturnitas.webp' },
            { name: 'Chicleteira Bicicleteira', color: 'secret', value: 3500000, cost: 750000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Chicleteira_Bicicleteira.webp' },
            { name: 'Fragola La La La', color: 'secret', value: 450000, cost: 125000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Fragola_La_La_La.webp' },
            { name: 'Agarrini la Palini', color: 'secret', value: 425000, cost: 80000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Agarrini_La_Palini.webp' },
            { name: 'Dragon Cannelloni', color: 'secret', value: 100000000, cost: 100000000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Dragon_Cannelloni.webp' },
            { name: 'Spaghetti Tualetti', color: 'secret', value: 60000000, cost: 750000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Spaghetti_Tualetti.webp' },
            { name: 'La Karkerkar Combinasion', color: 'secret', value: 2400000, cost: 100000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/La_Karkerkar_Combinasion.webp' },
            { name: 'Los Hotspotsitos', color: 'secret', value: 20000000, cost: 300000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Los_Hotspotsitos.webp' },
            { name: 'Esok Sekolah', color: 'secret', value: 30000000, cost: 750000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/EsokSekolah.webp' },
            { name: 'Tralaledon', color: 'secret', value: 27500000, cost: 3000000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Tralaledon.webp' },
            { name: 'Bisonte Giuppitere', color: 'secret', value: 30000000, cost: 750000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Bisonte_Giuppitere.webp' },
            { name: 'Los Matteos', color: 'secret', value: 300000, cost: 100000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Los_Matteos.webp' },
            { name: 'Nuclearo Dinossauro', color: 'secret', value: 15000000, cost: 2500000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Nuclearo_Dinossauro.webp' },
            { name: 'Ketchuru and Musturu', color: 'secret', value: 42500000, cost: 7500000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Ketchuru_and_Musturu.webp' },
            { name: 'La Supreme Combinasion', color: 'secret', value: 40000000, cost: 7000000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/La_Supreme_Combinasion.webp' },
            { name: 'Ketupat Kepat', color: 'secret', value: 35000000, cost: 5000000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Ketupat_Kepat.webp' },
            
            { name: 'Strawberry Elephant', color: 'og', value: 250000000, cost: 500000000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Strawberry_Elephant.webp' },
            
            { name: 'Carloo', color: 'admin', value: 13500, cost: 4500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Carloo.webp' },
            { name: 'Alessio', color: 'admin', value: 85000, cost: 17500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Alessio.webp' },
            { name: 'Los Bombinitos', color: 'admin', value: 220000, cost: 42500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Los_Bombinitos.webp' },
            { name: 'Crabbo Limonetta', color: 'admin', value: 235000, cost: 46000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Crabbo_Limonetta.webp' },
            { name: 'Blackhole Goat', color: 'admin', value: 400000, cost: 75000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Blackhole_Goat.webp' },
            { name: 'Los Spyderinis', color: 'admin', value: 450000, cost: 250000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Los_Spyderinis.webp' },
            { name: 'Guerriro Digitale', color: 'admin', value: 550000, cost: 120000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Guerriro_Digitale.webp' },
            
            { name: 'Raccooni Jandelini', color: 'exclusive', value: 12, cost: 1300, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Raccooni_Jandelini.webp' },
            { name: 'Gattatino Nyanino', color: 'exclusive', value: 35000, cost: 7500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Gattatino_Nyanino.webp' },
            { name: 'Matteo', color: 'exclusive', value: 50000, cost: 10000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Matteo.webp' },
            { name: 'Espresso Signora', color: 'exclusive', value: 70000, cost: 25000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Espresso_Signora.webp' },
            { name: 'Unclito Samito', color: 'exclusive', value: 75000, cost: 20000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Unclito_Samito.webp' },
            { name: 'Urubini Flamenguini', color: 'exclusive', value: 150000, cost: 30000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Urubini_Flamenguini.webp' },
            { name: 'Karkerkar Kurkur', color: 'exclusive', value: 300000, cost: 100000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Karkerkar_Kurkur.webp' },
            { name: 'Sammyini Spyderini', color: 'exclusive', value: 325000, cost: 100000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Sammyni_Spyderini.webp' },
            { name: 'Dul Dul Dul', color: 'exclusive', value: 375000, cost: 150000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Dul_Dul_Dul.webp' },
            
            { name: 'Chihuanini Taconini', color: 'taco', value: 45000, cost: 8500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Chihuanini_Taconini.webp' },
            { name: 'Tipi Topi Taco', color: 'taco', value: 75000, cost: 20000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Tipi_Topi_Taco.webp' },
            { name: 'Gattito Tacoto', color: 'taco', value: 495000, cost: 32500000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Gattito_Tacoto.webp' },
            { name: 'Bombardini Tortinii', color: 'taco', value: 225000, cost: 50000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Bombardini_Tortinii.webp' },
            { name: 'Los Tipi Tacos', color: 'taco', value: 260000, cost: 46000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Los_Tipi_Tacos.webp' },
            { name: 'Nooo My Hotspot', color: 'taco', value: 1500000, cost: 500000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Nooo_My_Hotspot.webp' },
            { name: 'Los Nooo My Hotspotsitos', color: 'taco', value: 5000000, cost: 1000000000, img: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Los_Nooo_My_Hotspotsitos.webp' }
        ];

        const mutations = [
            { name: 'Enhanced', multiplier: 1.5 },
            { name: 'Supercharged', multiplier: 2.0 },
            { name: 'Radiant', multiplier: 3.0 },
            { name: 'Silver', multiplier: 1.5 },
            { name: 'Golden', multiplier: 2.0 },
            { name: 'Diamond', multiplier: 3.0 },
            { name: 'Shiny', multiplier: 5.0 },
        ];

        const rarityGroups = {};
        rarities.forEach(r => {
            if (!rarityGroups[r.color]) rarityGroups[r.color] = [];
            rarityGroups[r.color].push(r);
        });

        const pathCategories = ['common', 'rare', 'epic', 'legendary', 'mythic', 'god', 'secret', 'og'];
        const pathCategoryWeights = [60, 15, 10, 7, 4, 2, 1, 1];
        const luckyCategories = ['admin', 'exclusive', 'taco'];
        const luckyImages = {
            admin: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Admin_Lucky_Block.webp',
            exclusive: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Secret_Lucky_Block.webp',
            taco: 'https://suspicioyt.github.io/perunverse/gameverse/img/brainrots/Taco_Lucky_Block.webp'
        };

        const rarityOrder = {
            common: 1,
            rare: 2,
            epic: 3,
            legendary: 4,
            mythic: 5,
            god: 6,
            secret: 7,
            og: 8,
            admin: 9,
            exclusive: 10,
            taco: 11
        };

        function weightedRandom(options, weights) {
            let total = weights.reduce((a, b) => a + b, 0);
            let rand = Math.random() * total;
            let cum = 0;
            for (let i = 0; i < options.length; i++) {
                cum += weights[i];
                if (rand < cum) return options[i];
            }
            return options[0];
        }

        setInterval(createItemOnPath, 3000);

        function getRandomRarity(group) {
            if (!Array.isArray(group) || group.length === 0) {
                console.error('Group is not a valid array or is empty:', group);
                return rarityGroups['common'][0];
            }
            return group[Math.floor(Math.random() * group.length)];
        }

        function createItemOnPath() {
            if (Math.random() < 0.01) {
                createLuckyBlock();
            } else {
                createBrainrot();
            }
        }

        function createBrainrot() {
            const category = weightedRandom(pathCategories, pathCategoryWeights);
            const group = rarityGroups[category] || rarityGroups['common'];
            const rarity = getRandomRarity(group);
            const isMutated = Math.random() < 0.1; // 10% szansy na mutację
            const mutation = isMutated ? mutations[Math.floor(Math.random() * mutations.length)] : null;
            const brainrot = document.createElement('div');
            brainrot.classList.add('brainrot', rarity.color);
            const displayName = mutation ? `${rarity.name} (${mutation.name})` : rarity.name;
            const value = mutation ? rarity.value * mutation.multiplier : rarity.value;
            const cost = mutation ? rarity.cost * mutation.multiplier : rarity.cost;
            brainrot.innerHTML = `<img src="${rarity.img}" alt="${displayName}"><span>${displayName}<br>(${formatMoney(cost)})<br>+${formatMoney(value)}/s</span>`;
            brainrot.style.left = '-110px';
            brainrot.style.top = '110px';
            gameContainer.appendChild(brainrot);

            const brainrotData = {
                element: brainrot,
                rarity: {
                    name: rarity.name,
                    color: rarity.color,
                    value: value,
                    cost: cost,
                    img: rarity.img
                },
                multiplier: 1,
                position: -110,
                inBase: false,
                station: null,
                pendingMoney: 0
            };
            brainrots.push(brainrotData);

            brainrot.addEventListener('click', () => buyBrainrot(brainrotData));

            if (pathCategories.indexOf(category) >= 2) {
                setInterval(() => {
                    if (brainrotData.inBase) {
                        createParticles(brainrot.element, 3);
                    }
                }, 2000);
            }
            saveGame();
        }

        function createLuckyBlock() {
            const category = luckyCategories[Math.floor(Math.random() * luckyCategories.length)];
            const lucky = document.createElement('div');
            lucky.classList.add('lucky-block');
            const cost = 100000000;
            const imgSrc = luckyImages[category];
            lucky.innerHTML = `<img src="${imgSrc}" alt="Lucky Block"><span>Lucky ${category}<br>(${formatMoney(cost)})</span>`;
            lucky.style.left = '-110px';
            lucky.style.top = '110px';
            gameContainer.appendChild(lucky);

            const luckyData = {
                element: lucky,
                category: category,
                cost: cost,
                position: -110,
                bought: false
            };
            luckyItems.push(luckyData);

            lucky.addEventListener('click', () => buyLuckyBlock(luckyData));
            saveGame();
        }

        function buyLuckyBlock(lucky) {
            if (money >= lucky.cost && !lucky.bought) {
                money -= lucky.cost;
                lucky.bought = true;
                updateMoney();
                lucky.element.remove();
                const group = rarityGroups[lucky.category] || rarityGroups['common'];
                const rarity = getRandomRarity(group);
                const isMutated = Math.random() < 0.1; // 10% szansy na mutację
                const mutation = isMutated ? mutations[Math.floor(Math.random() * mutations.length)] : null;
                const displayName = mutation ? `${rarity.name} (${mutation.name})` : rarity.name;
                const value = mutation ? rarity.value * mutation.multiplier : rarity.value;
                const cost = mutation ? rarity.cost * mutation.multiplier : rarity.cost;
                const dropped = {
                    rarity: {
                        name: rarity.name,
                        color: rarity.color,
                        value: value,
                        cost: cost,
                        img: rarity.img
                    },
                    multiplier: 1,
                    inBase: false,
                    pendingMoney: 0
                };
                dropped.element = document.createElement('div');
                dropped.element.classList.add('brainrot', rarity.color);
                dropped.element.innerHTML = `<img src="${rarity.img}" alt="${displayName}"><span>${displayName} x${dropped.multiplier} +${formatMoney(value * dropped.multiplier)}/s</span>`;
                brainrots.push(dropped);
                transportToBase(dropped);
                createParticles(dropped.element, 20);
                saveGame();
            }
        }

        function animate() {
            const now = performance.now();
            const delta = (now - lastFrameTime) / 1000;
            lastFrameTime = now;

            brainrots.forEach(brainrot => {
                if (!brainrot.inBase && brainrot.position < 1000) {
                    brainrot.position += 50 * delta;
                    brainrot.element.style.left = brainrot.position + 'px';
                } else if (brainrot.position >= 1000 && !brainrot.inBase) {
                    brainrot.element.remove();
                    brainrots = brainrots.filter(b => b !== brainrot);
                }
            });

            luckyItems.forEach(lucky => {
                if (!lucky.bought && lucky.position < 1000) {
                    lucky.position += 50 * delta;
                    lucky.element.style.left = lucky.position + 'px';
                } else if (lucky.position >= 1000 && !lucky.bought) {
                    lucky.element.remove();
                    luckyItems = luckyItems.filter(l => l !== lucky);
                }
            });

            requestAnimationFrame(animate);
        }
        requestAnimationFrame(animate);

        function buyBrainrot(brainrot) {
            const cost = brainrot.rarity.cost;
            if (money >= cost && !brainrot.inBase) {
                money -= cost;
                updateMoney();
                transportToBase(brainrot);
                createParticles(brainrot.element, 10);
                saveGame();
            }
        }

        function transportToBase(brainrot) {
            for (let i = 0; i < stations.length; i++) {
                if (!stations[i].hasChildNodes()) {
                    brainrot.inBase = true;
                    brainrot.station = i;
                    brainrot.element.id = `brainrot-${Date.now()}-${Math.random()}`; // Unikalne ID dla drag-and-drop
                    brainrot.element.draggable = true;
                    stations[i].appendChild(brainrot.element);
                    brainrot.element.style.position = 'static';
                    brainrot.element.style.top = 'auto';
                    brainrot.element.style.left = 'auto';
                    brainrot.element.innerHTML = `<img src="${brainrot.rarity.img}" alt="${brainrot.rarity.name}"><span>${brainrot.rarity.name} x${brainrot.multiplier} +${formatMoney(brainrot.rarity.value * brainrot.multiplier)}/s</span>`;

                    const bubble = document.createElement('div');
                    bubble.classList.add('money-bubble');
                    stations[i].appendChild(bubble);
                    bubble.addEventListener('click', () => collectMoney(brainrot, bubble));

                    brainrot.element.addEventListener('contextmenu', (e) => {
                        e.preventDefault();
                        sellBrainrot(brainrot);
                    });
                    brainrot.element.addEventListener('dblclick', () => mergeBrainrots(brainrot));
                    brainrot.element.addEventListener('dragstart', (e) => {
                        e.dataTransfer.setData('text/plain', brainrot.element.id);
                    });

                    // Natychmiastowe rozpoczęcie zbierania pieniędzy
                    brainrot.pendingMoney += brainrot.rarity.value * brainrot.multiplier;
                    updateBubble(bubble, brainrot.pendingMoney);

                    setInterval(() => {
                        if (brainrot.inBase) {
                            brainrot.pendingMoney += brainrot.rarity.value * brainrot.multiplier;
                            updateBubble(bubble, brainrot.pendingMoney);
                            saveGame();
                        }
                    }, 1000);

                    unlocked.add(brainrot.rarity.name); // Odblokowanie w indexie po dodaniu do bazy
                    updateIndex();
                    updateIncome();
                    saveGame();
                    return;
                }
            }
        }

        function updateBubble(bubble, amount) {
            if (amount > 0) {
                bubble.textContent = `+${formatMoney(amount)}`;
                bubble.classList.add('visible');
            } else {
                bubble.classList.remove('visible');
            }
        }

        function collectMoney(brainrot, bubble) {
            money += brainrot.pendingMoney;
            brainrot.pendingMoney = 0;
            updateBubble(bubble, 0);
            updateMoney();
            createParticles(bubble, 5);
            saveGame();
        }

        function sellBrainrot(brainrot) {
            if (brainrot.inBase) {
                const station = stations[brainrot.station];
                station.innerHTML = '';
                brainrots = brainrots.filter(b => b !== brainrot);
                money += brainrot.rarity.cost * 0.5;
                updateMoney();
                updateIncome();
                saveGame();
            }
        }

        function mergeBrainrots(brainrot) {
            if (brainrot.inBase) {
                const sameRarity = brainrots.filter(b => b.inBase && b.rarity.name === brainrot.rarity.name && b !== brainrot && b.multiplier === brainrot.multiplier);
                if (sameRarity.length > 0) {
                    const target = sameRarity[0];
                    target.multiplier += brainrot.multiplier;
                    target.element.innerHTML = `<img src="${target.rarity.img}" alt="${target.rarity.name}"><span>${target.rarity.name} x${target.multiplier} +${formatMoney(target.rarity.value * target.multiplier)}/s</span>`;
                    stations[brainrot.station].innerHTML = '';
                    brainrots = brainrots.filter(b => b !== brainrot);
                    updateIncome();
                    createParticles(target.element, 15);
                    saveGame();
                }
            }
        }

        function updateMoney() {
            moneyDisplay.textContent = `Pieniądze: ${formatMoney(money)}`;
        }

        function updateIncome() {
            incomePerSecond = brainrots.reduce((sum, b) => b.inBase ? sum + b.rarity.value * b.multiplier : sum, 0);
            incomeDisplay.textContent = `Dochód/s: ${formatMoney(incomePerSecond)}`;
        }

        function formatMoney(amount) {
            const units = ['', 'K', 'M', 'B', 'T', 'Qa', 'Qi', 'Sx', 'Sp', 'Oc', 'No', 'Dc'];
            let unitIndex = 0;
            let scaled = amount;
            while (scaled >= 1000 && unitIndex < units.length - 1) {
                scaled /= 1000;
                unitIndex++;
            }
            return `${scaled.toFixed(2)}${units[unitIndex]}`;
        }

        function createParticles(target, count) {
            const rect = target.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;

            for (let i = 0; i < count; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                particle.style.left = centerX + 'px';
                particle.style.top = centerY + 'px';
                particle.style.setProperty('--dx', (Math.random() - 0.5) * 100 + 'px');
                particle.style.setProperty('--dy', (Math.random() - 0.5) * 100 + 'px');
                document.body.appendChild(particle);
                setTimeout(() => particle.remove(), 800);
            }
        }

        showIndexButton.addEventListener('click', () => {
            indexModal.style.display = 'flex';
            updateIndex();
        });

        indexModal.addEventListener('click', (e) => {
            if (e.target === indexModal) {
                indexModal.style.display = 'none';
            }
        });

        async function deleteData() {
           setLocalData('gameverse', 'stealABrainrot', null);
        }
        resetGameButton.addEventListener('click', () => {
            if (confirm('Czy na pewno chcesz zresetować grę? Wszystkie postępy zostaną utracone!')) {
                money = 50;
                brainrots = [];
                luckyItems = [];
                incomePerSecond = 0;
                unlocked.clear();
                stations.forEach(station => station.innerHTML = '');
                updateMoney();
                updateIncome();
                updateIndex();
                deleteData();
            }
        });

        function showBrainrotDetails(rarity) {
            const modal = document.createElement('div');
            modal.classList.add('modal');
            modal.style.position = 'fixed';
            modal.style.top = '0';
            modal.style.left = '0';
            modal.style.width = '100%';
            modal.style.height = '100%';
            modal.style.background = 'rgba(0, 0, 0, 0.7)';
            modal.style.display = 'flex';
            modal.style.justifyContent = 'center';
            modal.style.alignItems = 'center';
            modal.style.zIndex = '2000';

            const content = document.createElement('div');
            content.style.background = '#1e293b';
            content.style.borderRadius = '10px';
            content.style.padding = '20px';
            content.style.color = '#fff';
            content.style.maxWidth = '400px';
            content.style.textAlign = 'center';
            content.innerHTML = `
                <img src="${rarity.img}" alt="${rarity.name}" style="width: 100px; height: 100px; border-radius: 50%; border: 2px solid #fff;">
                <h3>${rarity.name}</h3>
                <p>Rzadkość: ${rarity.color.charAt(0).toUpperCase() + rarity.color.slice(1)}</p>
                <p>Wartość: +${formatMoney(rarity.value)}/s</p>
                <p>Koszt: ${formatMoney(rarity.cost)}</p>
                <button onclick="this.parentElement.parentElement.remove()">Zamknij</button>
            `;
            modal.appendChild(content);
            document.body.appendChild(modal);

            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        function updateIndex() {
            indexSections.innerHTML = '';
            let filtered = rarities.filter(r => indexFilter.value === '' || r.color === indexFilter.value);
            if (indexSearch.value) {
                filtered = filtered.filter(r => r.name.toLowerCase().includes(indexSearch.value.toLowerCase()));
            }
            const sortOption = indexSort.value;
            filtered.sort((a, b) => {
                if (sortOption === 'rarity-asc') {
                    return rarityOrder[a.color] - rarityOrder[b.color];
                } else if (sortOption === 'rarity-desc') {
                    return rarityOrder[b.color] - rarityOrder[a.color];
                } else if (sortOption === 'name-asc') {
                    return a.name.localeCompare(b.name);
                } else if (sortOption === 'name-desc') {
                    return b.name.localeCompare(a.name);
                } else if (sortOption === 'value-asc') {
                    return a.value - b.value;
                } else if (sortOption === 'value-desc') {
                    return b.value - a.value;
                }
            });

            const grouped = {};
            filtered.forEach(r => {
                if (!grouped[r.color]) grouped[r.color] = [];
                grouped[r.color].push(r);
            });

            Object.keys(grouped).sort((a, b) => rarityOrder[a] - rarityOrder[b]).forEach(color => {
                const section = document.createElement('div');
                section.classList.add('rarity-section');
                section.innerHTML = `<h3>${color.charAt(0).toUpperCase() + color.slice(1)}</h3><div class="index-grid"></div>`;
                const grid = section.querySelector('.index-grid');
                grid.style.gridTemplateColumns = 'repeat(3, 1fr)';
                grouped[color].forEach(r => {
                    const item = document.createElement('div');
                    item.classList.add('index-item');
                    item.innerHTML = `<img src="${r.img}" alt="${r.name}" style="width: 50px; height: 50px; border-radius: 50%; border: 2px solid #fff;">`;
                    item.style.opacity = unlocked.has(r.name) ? '1' : '0.2';
                    item.style.cursor = 'pointer';
                    item.addEventListener('click', () => showBrainrotDetails(r));
                    grid.appendChild(item);
                });
                indexSections.appendChild(section);
            });
        }

        indexSearch.addEventListener('input', updateIndex);
        indexSort.addEventListener('change', updateIndex);
        indexFilter.addEventListener('change', updateIndex);

        async function saveGame() {
            const gameState = {
                money: money,
                brainrots: brainrots.filter(b => b.inBase).map(b => ({
                    rarity: b.rarity.name,
                    multiplier: b.multiplier,
                    station: b.station,
                    pendingMoney: b.pendingMoney
                })),
                unlocked: Array.from(unlocked)
            };
            setLocalData('gameverse', 'stealABrainrot', JSON.stringify(gameState));
        }

        async function loadGame() {
            const saved = getLocalData('gameverse', 'stealABrainrot');
            if (saved) {
                const gameState = JSON.parse(saved);
                money = gameState.money || 50;
                unlocked = new Set(gameState.unlocked || []);
                brainrots = [];
                gameState.brainrots.forEach(b => {
                    const rarity = rarities.find(r => r.name === b.rarity);
                    if (rarity && b.station < stations.length) {
                        const brainrot = {
                            rarity: rarity,
                            multiplier: b.multiplier,
                            inBase: true,
                            station: b.station,
                            pendingMoney: b.pendingMoney
                        };
                        brainrot.element = document.createElement('div');
                        brainrot.element.classList.add('brainrot', rarity.color);
                        brainrot.element.id = `brainrot-${Date.now()}-${Math.random()}`;
                        brainrot.element.draggable = true;
                        brainrot.element.innerHTML = `<img src="${rarity.img}" alt="${rarity.name}"><span>${rarity.name} x${b.multiplier} +${formatMoney(rarity.value * b.multiplier)}/s</span>`;
                        stations[b.station].appendChild(brainrot.element);
                        brainrots.push(brainrot);

                        const bubble = document.createElement('div');
                        bubble.classList.add('money-bubble');
                        stations[b.station].appendChild(bubble);
                        updateBubble(bubble, b.pendingMoney);
                        bubble.addEventListener('click', () => collectMoney(brainrot, bubble));

                        brainrot.element.addEventListener('contextmenu', (e) => {
                            e.preventDefault();
                            sellBrainrot(brainrot);
                        });
                        brainrot.element.addEventListener('dblclick', () => mergeBrainrots(brainrot));
                        brainrot.element.addEventListener('dragstart', (e) => {
                            e.dataTransfer.setData('text/plain', brainrot.element.id);
                        });

                        setInterval(() => {
                            if (brainrot.inBase) {
                                brainrot.pendingMoney += brainrot.rarity.value * brainrot.multiplier;
                                updateBubble(bubble, brainrot.pendingMoney);
                                saveGame();
                            }
                        }, 1000);
                    }
                });
                updateMoney();
                updateIncome();
                updateIndex();
            }
        }

        loadGame();

        // Drag-and-drop dla stacji
        stations.forEach(station => {
            station.addEventListener('dragover', (e) => {
                e.preventDefault();
                station.classList.add('drag-over');
            });
            station.addEventListener('dragleave', () => {
                station.classList.remove('drag-over');
            });
            station.addEventListener('drop', (e) => {
                e.preventDefault();
                station.classList.remove('drag-over');
                const draggedId = e.dataTransfer.getData('text/plain');
                const dragged = document.getElementById(draggedId);
                if (dragged && dragged.classList.contains('brainrot')) {
                    const sourceBrainrot = brainrots.find(b => b.element === dragged);
                    const sourceStation = stations[sourceBrainrot.station];
                    const targetStation = station;
                    if (sourceStation !== targetStation) {
                        if (targetStation.hasChildNodes()) {
                            // Merge, jeśli ta sama rzadkość i mnożnik
                            const targetBrainrot = brainrots.find(b => b.element === targetStation.firstChild);
                            if (targetBrainrot.rarity.name === sourceBrainrot.rarity.name && targetBrainrot.multiplier === sourceBrainrot.multiplier) {
                                targetBrainrot.multiplier += sourceBrainrot.multiplier;
                                targetBrainrot.element.innerHTML = `<img src="${targetBrainrot.rarity.img}" alt="${targetBrainrot.rarity.name}"><span>${targetBrainrot.rarity.name} x${targetBrainrot.multiplier} +${formatMoney(targetBrainrot.rarity.value * targetBrainrot.multiplier)}/s</span>`;
                                sourceStation.innerHTML = '';
                                brainrots = brainrots.filter(b => b !== sourceBrainrot);
                                updateIncome();
                                createParticles(targetBrainrot.element, 15);
                                saveGame();
                            }
                        } else {
                            // Przesunięcie na pustą stację
                            targetStation.appendChild(dragged);
                            sourceBrainrot.station = Array.from(stations).indexOf(targetStation);
                            sourceStation.innerHTML = '';
                            saveGame();
                        }
                    }
                }
            });
        });
    </script>
</body>
</html>